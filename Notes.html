<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOTES </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">



    <style>
        :root {
            --ios-blur: blur(20px) saturate(180%);
            --accent: #007aff;
        }

        body {
            background: #ffffff;
            margin: 0;
            overflow: hidden;
            height: 100vh;
            font-family: 'Caveat', cursive;
            touch-action: none;
        }

        .note,
        .note textarea,
        .note button {
            color: inherit;
        }


        /* --- THE INFINITE WORLD --- */
        #world-container {
            position: absolute;
            width: 100vw;
            height: 100vh;
            cursor: grab;
            overflow: hidden;
        }

        #world {
            position: absolute;
            width: 1px;
            height: 1px;
            transform-origin: 0 0;
            will-change: transform;
        }

        #grid-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(90deg, rgba(0, 0, 0, 0.08) 1px, transparent 1px),
                linear-gradient(rgba(0, 0, 0, 0.08) 1px, transparent 1px);
            z-index: -1;
            transform-origin: 0 0;
        }

        /* --- iOS LIQUID GLASS NOTES --- */
        .note {
            position: absolute;
            width: 260px;
            height: 210px;
            min-width: 160px;
            min-height: 120px;
            border-radius: 24px;
            backdrop-filter: var(--ios-blur);
            -webkit-backdrop-filter: var(--ios-blur);
            border: 1px solid rgba(255, 255, 255, 0.4);
            display: flex;
            flex-direction: column;
            resize: both;
            overflow: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transform: rotate(var(--rotation));
            transition: background-color 0.3s, transform 0.2s ease-out;
        }

        .note.dragging {
            transform: rotate(0deg) scale(1.05);
            z-index: 99999 !important;
        }

        .note-header {
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            cursor: move;
            background: rgba(255, 255, 255, 0.2);
        }

        .note-body {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            outline: none;
            font-size: 16px;
            color: inherit;
            font-family: inherit;
            resize: none;
        }

        .note-body::-webkit-scrollbar {
            width: 4px;
        }

        .note-body::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        /* CIRCULAR PICKER FIX */
        .color-dot {
            appearance: none;
            -webkit-appearance: none;
            border: none;
            width: 22px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            background: none;
            padding: 0;
            overflow: hidden;
        }

        .color-dot::-webkit-color-swatch {
            border-radius: 50%;
            border: 1px solid rgba(0, 0, 0, 0.15);
        }

        /* --- UI CONTROLS --- */
        .fab-group {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column-reverse;
            align-items: center;
            gap: 15px;
            z-index: 100000;
        }

        .fab-main {
            width: 40px;
            height: 40px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.4);
        }

        .fab-sub {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            opacity: 0;
            transform: scale(0);
            transition: 0.3s;
        }

        .fab-group:hover .fab-sub {
            opacity: 1;
            transform: scale(1);
        }

        .controls-left {
            position: fixed;
            bottom: 30px;
            left: 30px;
            display: flex;
            gap: 10px;
            z-index: 100000;
        }

        .btn-ui {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: var(--ios-blur);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 14px;
            font-size: 24px;
            cursor: pointer;
        }


        .inf {
            position: relative;
        }

        .info-box {
            position: absolute;
            text-align: left;
            bottom: -50px;
            right: 50px;
            width: 260px;
            padding: 16px;
            backdrop-filter: var(--ios-blur);
            -webkit-backdrop-filter: var(--ios-blur);
            background: #21c74a;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
            font-family: 'Caveat', cursive;
            font-size: 16px;
            color: #ffffff;
            opacity: 0;
            transform: translateY(12px) scale(0.95);
            transition: opacity 0.25s ease, transform 0.25s ease;
            pointer-events: none;
            z-index: 999999;
        }

        .inf:hover .info-box {
            opacity: 1;
            transform: translateY(0) scale(1);
        }


        .info {
            pointer-events: none;
        }

        .info-box {
            pointer-events: auto;
        }
    </style>
</head>

<body>

    <div id="grid-bg"></div>
    <div id="world-container">
        <div id="world">
            <div id="board"></div>
        </div>
    </div>

    <div class="controls-left">
        <button class="btn-ui" onclick="adjustZoom(0.1)">+</button>
        <button class="btn-ui" onclick="adjustZoom(-0.1)">-</button>
        <button class="btn-ui" onclick="resetView()">⟲</button>
    </div>

    <div class="fab-group">



        <button class="fab-main" onclick="createNote()">+</button>
        <button class="fab-sub inf" style="background:#34c759">
            <i class="fa-solid fa-info"></i>

            <div class="info-box">
                • Click <b>+</b> to add notes<br>
                • Drag notes to move them<br>
                • Resize from corners<br>
                • SHIFT + Drag → Pan board<br>
                • CTRL + Z → Undo<br>
                • CTRL + L → Align notes<br>
                • Set Colors of note
            </div>
        </button>
        <button class="fab-sub" style="background:#ff3b30 ; font-size: 16px;" onclick="deleteAll()"><i
                class="fa-solid fa-trash"></i> </button>
    </div>

    <script>
        let cam = { x: 0, y: 0, zoom: 1 }, activeNote = null, noteOffset = { x: 0, y: 0 };
        let isPanning = false, panStart = { x: 0, y: 0 }, historyStack = [], highestZ = 1000;

        const world = document.getElementById('world'), grid = document.getElementById('grid-bg');

        function updateView() {
            world.style.transform = `translate(${cam.x}px, ${cam.y}px) scale(${cam.zoom})`;
            grid.style.backgroundPosition = `${cam.x}px ${cam.y}px`;
            grid.style.backgroundSize = `${20 * cam.zoom}px ${20 * cam.zoom}px`;
            save();
        }

        function adjustZoom(delta) { cam.zoom = Math.max(0.2, Math.min(3, cam.zoom + delta)); updateView(); }
        function resetView() { cam = { x: 0, y: 0, zoom: 1 }; updateView(); }

        // --- INFINITE PANNING LOGIC ---
        window.addEventListener('mousedown', (e) => {
            if (e.button === 1 || (e.button === 0 && e.shiftKey)) {
                isPanning = true; panStart = { x: e.clientX - cam.x, y: e.clientY - cam.y };
                document.body.style.cursor = 'grabbing';
            }
        });

        window.addEventListener('mousemove', (e) => {
            if (isPanning) { cam.x = e.clientX - panStart.x; cam.y = e.clientY - panStart.y; updateView(); }
            if (activeNote) {
                // Edge Panning
                if (e.clientX > window.innerWidth - 60) cam.x -= 15;
                if (e.clientX < 60) cam.x += 15;
                if (e.clientY > window.innerHeight - 60) cam.y -= 15;
                if (e.clientY < 60) cam.y += 15;

                let nx = (e.clientX - cam.x) / cam.zoom - noteOffset.x;
                let ny = (e.clientY - cam.y) / cam.zoom - noteOffset.y;
                activeNote.style.left = nx + 'px'; activeNote.style.top = ny + 'px';
                updateView();
            }
        });

        window.addEventListener('mouseup', () => { isPanning = false; if (activeNote) activeNote.classList.remove('dragging'); activeNote = null; document.body.style.cursor = 'default'; });

        // --- NOTES LOGIC ---
        function hexToRgba(hex, a = 0.6) {
            const r = parseInt(hex.slice(1, 3), 16), g = parseInt(hex.slice(3, 5), 16), b = parseInt(hex.slice(5, 7), 16);
            return `rgba(${r},${g},${b},${a})`;
        }
        function getTextColor(hex) {
            const r = parseInt(hex.substr(1, 2), 16);
            const g = parseInt(hex.substr(3, 2), 16);
            const b = parseInt(hex.substr(5, 2), 16);

            // Perceived brightness formula
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;

            return brightness < 140 ? '#ffffff' : '#000000';
        }

        function createNote(restore = null, isUndo = false) {
            const note = document.createElement('div');
            const id = 'n-' + Date.now(); note.id = id; note.className = 'note';
            const palette = ['#ffd60a', '#34c759', '#007aff', '#ff3b30', '#af52de'];
            const startHex = palette[Math.floor(Math.random() * palette.length)];

            const data = restore || {
                x: (Math.random() * (window.innerWidth - 300) - cam.x) / cam.zoom,
                y: (Math.random() * (window.innerHeight - 300) - cam.y) / cam.zoom,
                hex: startHex, rgba: hexToRgba(startHex), rot: ((Math.random() * 6) - 3) + 'deg', content: ''
            };
            note.style.color = getTextColor(data.hex);
            note.style.backgroundColor = data.rgba;
            note.style.color = getTextColor(data.hex);
            note.style.setProperty('--rotation', data.rot);

            note.style.left = data.x + 'px'; note.style.top = data.y + 'px';
            note.style.backgroundColor = data.rgba;
            note.style.setProperty('--rotation', data.rot);
            note.style.zIndex = ++highestZ;

            note.innerHTML = `
            <div class="note-header" onmousedown="grabNote(event, '${id}')">
                <input type="color" class="color-dot" value="${data.hex}" oninput="updateNoteColor('${id}', this.value)">
                <button style="background:none;border:none;cursor:pointer;color:inherit;font-size:18px" onclick="deleteNote('${id}')">✕</button>
            </div>
            <textarea class="note-body" placeholder="Write message..." oninput="save()">${data.content}</textarea>`;
            document.getElementById('board').appendChild(note);
            if (!isUndo) historyStack.push({ type: 'add', id: id });
            save();
        }

        function grabNote(e, id) {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') return;
            activeNote = document.getElementById(id); activeNote.style.zIndex = ++highestZ;
            activeNote.classList.add('dragging');
            noteOffset.x = (e.clientX - cam.x) / cam.zoom - activeNote.offsetLeft;
            noteOffset.y = (e.clientY - cam.y) / cam.zoom - activeNote.offsetTop;
        }

        function updateNoteColor(id, hex) {
            const el = document.getElementById(id);
            const rgba = hexToRgba(hex);

            el.style.backgroundColor = rgba;
            el.style.color = getTextColor(hex);
            save();
        }


        function deleteNote(id) {
            const el = document.getElementById(id);
            historyStack.push({ type: 'delete', id, x: el.offsetLeft, y: el.offsetTop, hex: el.querySelector('.color-dot').value, rgba: el.style.backgroundColor, rot: el.style.getPropertyValue('--rotation'), content: el.querySelector('textarea').value });
            el.remove(); save();
        }

        function deleteAll() { if (confirm("Clear board?")) { document.getElementById('board').innerHTML = ''; localStorage.clear(); historyStack = []; } }

        window.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'z') { e.preventDefault(); const a = historyStack.pop(); if (!a) return; if (a.type === 'add') document.getElementById(a.id)?.remove(); else createNote(a, true); save(); }
            if (e.ctrlKey && e.key === 'l') { e.preventDefault(); document.querySelectorAll('.note').forEach((n, i) => { n.style.left = (50 + (i % 5) * 280) + 'px'; n.style.top = (50 + Math.floor(i / 5) * 230) + 'px'; n.style.setProperty('--rotation', '0deg'); }); save(); }
        });

        function save() {
            const notes = Array.from(document.querySelectorAll('.note')).map(n => ({ x: n.offsetLeft, y: n.offsetTop, hex: n.querySelector('.color-dot').value, rgba: n.style.backgroundColor, rot: n.style.getPropertyValue('--rotation'), content: n.querySelector('textarea').value }));
            localStorage.setItem('final_pro_board_2025', JSON.stringify({ cam, notes }));
        }

        window.onload = () => {
            const saved = JSON.parse(localStorage.getItem('final_pro_board_2025'));
            if (saved) { cam = saved.cam; saved.notes.forEach(n => createNote(n, true)); updateView(); } else createNote();
        };
    </script>
</body>

</html>